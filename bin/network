#!/usr/bin/env bash

# Start up network related stuff.

set -ex

if [ -z "$1" ]; then
    echo "Missing network name"
    exit 1
fi

# For whatever reason, not setting this interface down will cause netctl to fail
# on this machine.
if [ "$HOSTNAME" == "system7" ]; then
    sudo ip link set wlo1 down
fi

# Connect to selected network.
sudo netctl start "$1"

# Cache passphrase so mbsync can use it.
echo "hello" | gpg -e --recipient scsmithr@gmail.com | gpg -d

# Periodically refresh emails.
systemctl start --user mbsync.timer
